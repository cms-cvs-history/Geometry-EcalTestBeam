process PROD  = 
{
    
    service = RandomNumberGeneratorService
    {

        untracked uint32 sourceSeed = 12345

        PSet moduleSeeds =
        {
            untracked uint32 VtxSmeared = 12345
            untracked uint32 g4SimHits = 9876
        }
    }

    service = MessageLogger
    {
	untracked vstring destinations = {"cout"}
	untracked vstring categories = { "FwkJob","BeamProfileVtxGenerator" }
    untracked vstring debugModules = { "VtxSmeared" }
	untracked PSet cout =
	{
        untracked string threshold = "DEBUG"  
        untracked PSet DEBUG = { untracked int32 limit = 0 }
	    untracked PSet default = { untracked int32 limit = 0 }
	    untracked PSet FwkJob  = { untracked int32 limit = -1 } # but FwkJob category - those unlimitted
        untracked PSet BeamProfileVtxGenerator = { untracked int32 limit = -1 }
	}
    }
    

   include "SimG4CMS/EcalTestBeam/test/data/crystal1104.cff"

   include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"
 
   module VtxSmeared = BeamProfileVtxGenerator
   {
         using common_beam_direction_parameters
         untracked double BeamSigmaX = 2.4
         untracked double BeamSigmaY = 2.4
         untracked bool GaussianProfile = false
   }
    

   # flat random E-gun
   #
   source = FlatRandomEGunSource
   {
      untracked int32 maxEvents = 10
      untracked PSet PGunParameters = 
      {
         # you can request more than 1 particle
         untracked vint32 PartID = {14}
         using common_beam_direction_parameters
         untracked double MinE   = 120.
         untracked double MaxE   = 120.
      }
      untracked int32 Verbosity = 0 # set to 1 (or greater)  for printouts
   }

    #Geometry
    #
    include "Geometry/EcalTestBeam/data/TBH4GeometryXML.cfi"
    es_module = TrackerGeometricDetESModule {}
    
    #Magnetic Field
    #
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    
    # Output of events, etc...
    #
    # Explicit note : since some histos/tree might be dumped directly,
    #                 better NOT use PoolOutputModule !
    
    # Detector simulation (Geant4-based)
    #
    include "SimG4Core/Application/data/g4SimHits.cfi"
    replace g4SimHits.Generator.HepMCProductLabel = "source"
    replace g4SimHits.UseMagneticField = false
    replace g4SimHits.Physics.type = "SimG4Core/Physics/DummyPhysics"
    replace g4SimHits.Physics.DummyEMPhysics = true
    replace g4SimHits.Physics.CutsPerRegion = false
    replace g4SimHits.Physics.Verbosity = 2
    replace g4SimHits.Watchers = { 
	{ string type = "MaterialBudgetAction"
	    PSet MaterialBudgetAction = {
		string HistogramList = "ECAL"
		string HistosFile = "matbdg_ECAL.root"
		string TextFile = "matbdg_ECAL.txt"
		# string TextFile = "None"  # "None" means this option 
		string TreeFile = "None"  # is NOT requested
		bool AllStepsToTree = 0
		vstring SelectedVolumes = {"TBH4BeamLine","ECAL"}
		string StopAfterProcess = "None"
	    }
    }
    }
    
    path p1 = { VtxSmeared, g4SimHits }
}		
